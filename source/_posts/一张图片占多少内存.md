---
title: 一张图片占多少内存
date: 2018-12-29 20:35:48
tags:
- 图片内存
categories:
- 内存检测
---
#### 一张图片到底占用多少内存呢？

　　1. 图片占用内存的计算公式：图片高度 * 图片宽度 * 一个像素占用的内存大小

　　2. 所以上面的图片占用内存是：800 * 600 * 4 byte = 1875KB = 1.83M 

上面的计算公式中，为什么是4byte呢？
4byte是跟图片的编码格式有关系

**在实际应用中而言,建议使用ARGB_8888以及RGB_565。 如果你不需要透明度,选择RGB_565,可以减少一半的内存占用.**

{% asset_img tu.PNG %}


#### 图片所在目录对内存的影响？

　　在Android中，图片的存放目录和手机的屏幕密度影响图片最终的大小，举个例子：

　　假设我们的图片放到xhdpi目录下，那么我们本文中的图片占用的内存大小如下：

　　屏幕密度为2的设备：800 * 600 * 4byte = 1.83M

　　屏幕密度为3的设备：800 * 1.5 * 600 * 1.5 * 4byte = 1.83 * 2.25M = 4.12M

　　所以，计算图片占用内存大小的时候，要考虑图片所在的目录跟设备密度，这两个因素其实影响的是图片的高宽，android会对图片进行拉升跟压缩。

{% asset_img tu2.PNG %}

{% asset_img tu1.PNG %}

{% asset_img tu3.PNG %}


一张图片对应 Bitmap 占用内存 = mBitmapHeight * mBitmapWidth * 4byte(ARGB_8888)；Native 方法中，mBitmapHeight = mOriginalHeight * (scale = opts.inTargetDensity / opts.inDensity) * 1/inSampleSize ；
由此可知，手机屏幕大小 1280 x 720（inTarget = 320），加载 xxhdpi （inDensity = 480）中的图片 1920 x 1080，scale = 320 / 480，inSampleSize = 1，最终获得的 Bitmap 的图像大小是 ：
mBitmapWidth = opts.outWidth = 1080 * (320 / 480) * 1/1 = 720，
mBitmapHeight = opt.outHeight = 1920 * (320 / 480) * 1/1 = 1280，
getAllocatedMemory() = mBitmapWidth * mBitmapHeight * 4 = Bitmap占用内存。
